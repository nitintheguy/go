<ion-content [fullscreen]="true" class="grocery-content">
  <!-- Enhanced Header Section -->
  <div class="header-section">
    <div class="header-background">
      <div class="floating-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
      </div>
    </div>
    
    <div class="header-top">
      <div class="header-left">
        <div class="go-text">GO</div>
        <div class="delivery-time">8 minutes • Free Delivery</div>
        <div class="location">
          <ion-icon name="location" class="location-icon"></ion-icon>
          Home - Floor 1st, ASG • 1.2 km away
        </div>
      </div>
      <div class="header-right">
        <div class="avatar-container">
          <ion-avatar class="profile-avatar">
            <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=100&h=100&fit=crop&crop=face" />
          </ion-avatar>
          <div class="online-indicator"></div>
        </div>
      </div>
    </div>

    <!-- Enhanced Search Bar -->
    <div class="search-section">
      <div class="search-container">
        <ion-searchbar
          [(ngModel)]="searchText"
          [placeholder]="currentPlaceholder"
          animated="true"
          class="custom-searchbar"
          debounce="500"
          (ionInput)="onSearchInput($event)"
          (ionClear)="clearSearch()">
        </ion-searchbar>
        <div class="search-decoration">
          <div class="pulse-dot"></div>
        </div>
      </div>
    </div>

    <!-- Enhanced Categories -->
    <div class="categories-section">
      <div class="categories-scroll">
        <ion-chip 
          *ngFor="let category of categories" 
          [class.active]="category.name === 'All'"
          class="category-chip"
          (click)="filterByCategory(category.name)">
          <div class="chip-icon-wrapper">
            <ion-icon [name]="category.icon"></ion-icon>
          </div>
          <ion-label>{{ category.name }}</ion-label>
        </ion-chip>
      </div>
    </div>
  </div>

  <!-- Search Results Section -->
  <div class="search-results-section" *ngIf="showSearchResults">
    <div class="section-header">
      <h3>Search Results</h3>
      <div class="results-count">{{ searchResults.length }} items found</div>
    </div>
    
    <div class="search-loading" *ngIf="isSearching">
      <div class="loading-spinner">
        <ion-spinner name="crescent"></ion-spinner>
      </div>
      <p>Searching...</p>
    </div>

    <div class="no-results" *ngIf="!isSearching && searchResults.length === 0">
      <ion-icon name="search-outline" class="no-results-icon"></ion-icon>
      <h4>No items found</h4>
      <p>Try searching for something else</p>
    </div>

    <div class="search-results-grid" *ngIf="!isSearching && searchResults.length > 0">
      <div *ngFor="let item of searchResults" class="search-result-item" (click)="viewItem(item)">
        <div class="item-badge" *ngIf="item.discount">-{{item.discount}}%</div>
        <img [src]="item.image" class="item-image" />
        <div class="item-info">
          <div class="item-name">{{ item.name }}</div>
          <div class="item-price">
            <span class="current-price">₹{{ item.price }}</span>
            <span class="original-price" *ngIf="item.originalPrice">₹{{ item.originalPrice }}</span>
          </div>
          <div class="item-weight">{{ item.weight }}</div>
          <div class="item-rating">
            <ion-icon name="star" class="rating-icon"></ion-icon>
            {{ item.rating }}
          </div>
        </div>
        
        <div class="add-btn-container" *ngIf="!isItemInCart(item.id)">
          <button class="add-btn" (click)="addToCart(item, $event)">
            <ion-icon name="add"></ion-icon>
          </button>
        </div>

        <div class="quantity-controls" *ngIf="isItemInCart(item.id)">
          <button class="qty-btn minus" (click)="decrementQuantity(item.id, $event)">
            <ion-icon name="remove"></ion-icon>
          </button>
          <span class="quantity">{{ getItemQuantity(item.id) }}</span>
          <button class="qty-btn plus" (click)="addToCart(item, $event)">
            <ion-icon name="add"></ion-icon>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content (Hidden when searching) -->
  <div *ngIf="!showSearchResults">
    <!-- Promo Banner -->
    <div class="promo-banner">
      <div class="banner-content">
        <div class="banner-text">
          <div class="banner-title">Free Delivery! </div>
          <div class="banner-subtitle">On orders above ₹199 • Shop now</div>
        </div>
        <div class="banner-icon">
          <ion-icon name="cart"></ion-icon>
        </div>
      </div>
    </div>

    <!-- Hero Section - Frequently Bought -->
    <div class="hero-section">
      <div class="section-header">
        <h2>Frequently Bought</h2>
        <button class="see-all-btn" [routerLink]="['/category', 'frequently-bought']">
          See All
          <ion-icon name="chevron-forward"></ion-icon>
        </button>
      </div>
      <div class="frequent-scroll">
        <div *ngFor="let item of frequentItems" class="frequent-item" (click)="viewItem(item)">
          <div class="item-badge" *ngIf="item.discount">-{{item.discount}}%</div>
          <img [src]="item.image" class="item-image" />
          <div class="item-info">
            <div class="item-name">{{ item.name }}</div>
            <div class="item-price">
              <span class="current-price">₹{{ item.price }}</span>
              <span class="original-price" *ngIf="item.originalPrice">₹{{ item.originalPrice }}</span>
            </div>
            <div class="item-weight">{{ item.weight }}</div>
            <div class="item-rating">
              <ion-icon name="star" class="rating-icon"></ion-icon>
              {{ item.rating }}
            </div>
          </div>
          
          <div class="add-btn-container" *ngIf="!isItemInCart(item.id)">
            <button class="add-btn" (click)="addToCart(item, $event)">
              <ion-icon name="add"></ion-icon>
            </button>
          </div>

          <div class="quantity-controls" *ngIf="isItemInCart(item.id)">
            <button class="qty-btn minus" (click)="decrementQuantity(item.id, $event)">
              <ion-icon name="remove"></ion-icon>
            </button>
            <span class="quantity">{{ getItemQuantity(item.id) }}</span>
            <button class="qty-btn plus" (click)="addToCart(item, $event)">
              <ion-icon name="add"></ion-icon>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Categories -->
    <div class="quick-categories">
      <div class="section-header">
        <h3>Quick Categories</h3>
      </div>
      <div class="categories-grid">
        <div *ngFor="let quickCat of quickCategories" class="quick-category" [routerLink]="['/category', quickCat.name]">
          <div class="category-icon" [style.background]="quickCat.color">
            <ion-icon [name]="quickCat.icon"></ion-icon>
          </div>
          <div class="category-name">{{ quickCat.name }}</div>
        </div>
      </div>
    </div>

    <!-- Main Grocery Categories -->
    <div class="main-categories">
      <div *ngFor="let category of groceryCategories" class="category-section">
        <div class="section-header">
          <h3><ion-icon [name]="category.icon"></ion-icon> {{ category.name }}</h3>
          <button class="see-all-btn" [routerLink]="['/category', category.name]">
            View All
            <ion-icon name="chevron-forward"></ion-icon>
          </button>
        </div>
        <div class="items-scroll">
          <div *ngFor="let item of category.items" class="grocery-item" (click)="viewItem(item)">
            <div class="item-badge" *ngIf="item.discount">-{{item.discount}}%</div>
            <img [src]="item.image" class="item-image" />
            <div class="item-info">
              <div class="item-name">{{ item.name }}</div>
              <div class="item-price">
                <span class="current-price">₹{{ item.price }}</span>
                <span class="original-price" *ngIf="item.originalPrice">₹{{ item.originalPrice }}</span>
              </div>
              <div class="item-weight">{{ item.weight }}</div>
              <div class="item-rating">
                <ion-icon name="star" class="rating-icon"></ion-icon>
                {{ item.rating }}
              </div>
            </div>
            
            <div class="add-btn-container" *ngIf="!isItemInCart(item.id)">
              <button class="add-btn" (click)="addToCart(item, $event)">
                <ion-icon name="add"></ion-icon>
              </button>
            </div>

            <div class="quantity-controls" *ngIf="isItemInCart(item.id)">
              <button class="qty-btn minus" (click)="decrementQuantity(item.id, $event)">
                <ion-icon name="remove"></ion-icon>
              </button>
              <span class="quantity">{{ getItemQuantity(item.id) }}</span>
              <button class="qty-btn plus" (click)="addToCart(item, $event)">
                <ion-icon name="add"></ion-icon>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Enhanced Footer -->
    <div class="footer">
      <div class="footer-content">
        <div class="footer-logo">
          <div class="go-text-small">GO</div>
          <div class="footer-tagline">Fresh Groceries Delivered</div>
        </div>
        <div class="footer-links">
          <a href="#" class="footer-link">About</a>
          <a href="#" class="footer-link">Contact</a>
          <a href="#" class="footer-link">Support</a>
        </div>
      </div>
      <p class="footer-copyright">Made with ❤️ by Go Grocery Team</p>
    </div>
  </div>

  <!-- Fixed Bottom Cart Bar -->
  <div class="bottom-cart-bar" [class.show]="showCartBubble">
    <div class="cart-bar-content">
      <div class="cart-info">
        <div class="cart-count-badge">{{ cartItemCount }} items</div>
        <div class="cart-total-text">₹{{ cartTotal }}</div>
      </div>
      <button class="view-cart-btn" (click)="viewCart()">
        View Cart
        <ion-icon name="arrow-forward"></ion-icon>
      </button>
    </div>
    <div class="cart-pulse-effect" [class.pulsing]="isCartPulsing"></div>
  </div>

  <!-- Cart Toast Notification -->
  <div class="cart-toast" [class.show]="isCartPulsing">
    <div class="toast-content">
      <ion-icon name="checkmark-circle" class="toast-icon"></ion-icon>
      <span class="toast-text">Item added to cart!</span>
    </div>
  </div>
</ion-content>